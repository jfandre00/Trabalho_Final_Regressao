# PASSO 1: CONFIGURAÇÃO DO AMBIENTE
# ----------------------------------
# Instalar pacotes (se ainda não tiver)
# install.packages("tidyverse")
# install.packages("corrplot")
# Carregar os pacotes que serão utilizados
library(tidyverse)
install.packages("tidyverse")
install.packages("corrplot")
dados <- read.csv("data/insurance.csv")
head(dados)
str(dados)
dados <- dados %>%
mutate(
sex = as.factor(sex),
smoker = as.factor(smoker),
region = as.factor(region)
)
dados <- dados %>%
mutate(
sex = as.factor(sex),
smoker = as.factor(smoker),
region = as.factor(region)
)
dados <- dados %>%
mutate(
sex = as.factor(sex),
smoker = as.factor(smoker),
region = as.factor(region)
)
dados <- dados %>%
mutate(
sex = as.factor(sex),
smoker = as.factor(smoker),
region = as.factor(region)
)
# Carregar os pacotes que vamos utilizar
library(tidyverse)
dados <- dados %>%
mutate(
sex = as.factor(sex),
smoker = as.factor(smoker),
region = as.factor(region)
)
library(corrplot)
str(dados)
colSums(is.na(dados))
ggplot(dados, aes(x = charges)) +
geom_histogram(aes(y = ..density..), fill = "skyblue", color = "white", bins = 30) +
geom_density(col = "red", size = 1) +
labs(
title = "Distribuição dos Custos Médicos (Charges)",
x = "Custos ($)",
y = "Densidade"
) +
theme_minimal()
# b) Visualizando a transformação logarítmica
ggplot(dados, aes(x = log(charges))) +
geom_histogram(aes(y = ..density..), fill = "lightgreen", color = "white", bins = 30) +
geom_density(col = "darkgreen", size = 1) +
labs(
title = "Distribuição dos Custos Médicos (Escala Logarítmica)",
x = "Log(Custos)",
y = "Densidade"
) +
theme_minimal()
# Charges vs. Smoker
ggplot(dados, aes(x = smoker, y = charges, fill = smoker)) +
geom_boxplot(show.legend = FALSE) +
labs(
title = "Custos Médicos: Fumantes vs. Não Fumantes",
x = "É Fumante?",
y = "Custos ($)"
) +
scale_y_continuous(labels = scales::dollar) + # Formata o eixo Y para dólar
theme_minimal()
# d) Relação de Charges com Preditores Quantitativos
# Charges vs. Age (colorindo por smoker para mais insights)
ggplot(dados, aes(x = age, y = charges)) +
geom_point(aes(color = smoker), alpha = 0.7) +
labs(
title = "Custo Médico vs. Idade",
subtitle = "Colorido por status de fumante",
x = "Idade",
y = "Custos ($)"
) +
theme_minimal()
modelo_1 <- lm(log(charges) ~ age + bmi + smoker, data = dados)
summary(modelo_1)
par(mfrow = c(2, 2))
plot(modelo_1)

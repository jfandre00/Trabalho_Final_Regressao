# PASSO 1: CONFIGURAÇÃO DO AMBIENTE
# ----------------------------------
# Instalar pacotes (se ainda não tiver)
# install.packages("tidyverse")
# install.packages("corrplot")
# Carregar os pacotes que serão utilizados
library(tidyverse)
install.packages("tidyverse")
install.packages("corrplot")
dados <- read.csv("data/insurance.csv")
head(dados)
str(dados)
dados <- dados %>%
mutate(
sex = as.factor(sex),
smoker = as.factor(smoker),
region = as.factor(region)
)
dados <- dados %>%
mutate(
sex = as.factor(sex),
smoker = as.factor(smoker),
region = as.factor(region)
)
dados <- dados %>%
mutate(
sex = as.factor(sex),
smoker = as.factor(smoker),
region = as.factor(region)
)
dados <- dados %>%
mutate(
sex = as.factor(sex),
smoker = as.factor(smoker),
region = as.factor(region)
)
# Carregar os pacotes que vamos utilizar
library(tidyverse)
dados <- dados %>%
mutate(
sex = as.factor(sex),
smoker = as.factor(smoker),
region = as.factor(region)
)
library(corrplot)
str(dados)
colSums(is.na(dados))
ggplot(dados, aes(x = charges)) +
geom_histogram(aes(y = ..density..), fill = "skyblue", color = "white", bins = 30) +
geom_density(col = "red", size = 1) +
labs(
title = "Distribuição dos Custos Médicos (Charges)",
x = "Custos ($)",
y = "Densidade"
) +
theme_minimal()
# b) Visualizando a transformação logarítmica
ggplot(dados, aes(x = log(charges))) +
geom_histogram(aes(y = ..density..), fill = "lightgreen", color = "white", bins = 30) +
geom_density(col = "darkgreen", size = 1) +
labs(
title = "Distribuição dos Custos Médicos (Escala Logarítmica)",
x = "Log(Custos)",
y = "Densidade"
) +
theme_minimal()
# Charges vs. Smoker
ggplot(dados, aes(x = smoker, y = charges, fill = smoker)) +
geom_boxplot(show.legend = FALSE) +
labs(
title = "Custos Médicos: Fumantes vs. Não Fumantes",
x = "É Fumante?",
y = "Custos ($)"
) +
scale_y_continuous(labels = scales::dollar) + # Formata o eixo Y para dólar
theme_minimal()
# d) Relação de Charges com Preditores Quantitativos
# Charges vs. Age (colorindo por smoker para mais insights)
ggplot(dados, aes(x = age, y = charges)) +
geom_point(aes(color = smoker), alpha = 0.7) +
labs(
title = "Custo Médico vs. Idade",
subtitle = "Colorido por status de fumante",
x = "Idade",
y = "Custos ($)"
) +
theme_minimal()
modelo_1 <- lm(log(charges) ~ age + bmi + smoker, data = dados)
summary(modelo_1)
par(mfrow = c(2, 2))
plot(modelo_1)
install.packages("IRkernel")
IRkernel::installspec()
install.packages("IRkernel")
IRkernel::installspec(user = FALSE)
library(tidyverse)
library(corrplot)
dados <- read.csv("data/insurance.csv")
head(dados)
str(dados)
dados <- dados %>%
mutate(
sex = as.factor(sex),
smoker = as.factor(smoker),
region = as.factor(region)
)
str(dados)
colSums(is.na(dados))
ggplot(dados, aes(x = charges)) +
geom_histogram(aes(y = ..density..), fill = "skyblue", color = "white", bins = 30) +
geom_density(col = "red", size = 1) +
labs(
title = "Distribuição dos Custos Médicos (Charges)",
x = "Custos ($)",
y = "Densidade"
) +
theme_minimal()
ggplot(dados, aes(x = log(charges))) +
geom_histogram(aes(y = ..density..), fill = "lightgreen", color = "white", bins = 30) +
geom_density(col = "darkgreen", size = 1) +
labs(
title = "Distribuição dos Custos Médicos (Escala Logarítmica)",
x = "Log(Custos)",
y = "Densidade"
) +
theme_minimal()
ggplot(dados, aes(x = smoker, y = charges, fill = smoker)) +
geom_boxplot(show.legend = FALSE) +
labs(
title = "Custos Médicos: Fumantes vs. Não Fumantes",
x = "É Fumante?",
y = "Custos ($)"
) +
scale_y_continuous(labels = scales::dollar) + # Formata o eixo Y para dólar
theme_minimal()
ggplot(dados, aes(x = age, y = charges)) +
geom_point(aes(color = smoker), alpha = 0.7) +
labs(
title = "Custo Médico vs. Idade",
subtitle = "Colorido por status de fumante",
x = "Idade",
y = "Custos ($)"
) +
theme_minimal()
ggplot(dados, aes(x = bmi, y = charges)) +
geom_point(aes(color = smoker), alpha = 0.7) +
labs(
title = "Custo Médico vs. IMC",
subtitle = "Colorido por status de fumante",
x = "IMC",
y = "Custos ($)"
) +
theme_minimal()
modelo_1 <- lm(log(charges) ~ age + bmi + smoker, data = dados)
summary(modelo_1)
par(mfrow = c(2, 2))
plot(modelo_1)
par(mfrow = c(1, 1))
fumantes <- subset(dados, smoker == "yes")
ggplot(fumantes, aes(x = age, y = bmi, color = charges)) +
geom_point(alpha = 0.8, size = 3) +
scale_color_gradient(low = "green", high = "red", labels = scales::dollar) +
labs(
title = "Relação entre Idade, IMC e Custos (Fumantes com IMC >= 25)",
x = "Idade",
y = "Índice de Massa Corporal (IMC)",
color = "Custos" # Título da legenda de cores
) +
theme_minimal()
plot_ly(data = fumantes,
x = ~age,
y = ~bmi,
z = ~charges,
type = 'scatter3d',
mode = 'markers',
marker = list(color = ~charges, colorscale = 'Viridis', showscale = TRUE)) %>%
layout(title = "Custos vs. Idade e IMC em 3D")
library(plotly)
install.packages("plotly")
library(plotly)
plot_ly(data = fumantes,
x = ~age,
y = ~bmi,
z = ~charges,
type = 'scatter3d',
mode = 'markers',
marker = list(color = ~charges, colorscale = 'Viridis', showscale = TRUE)) %>%
layout(title = "Custos vs. Idade e IMC em 3D")
fumantes <- fumantes %>%
mutate(
is_obese = ifelse(bmi >= 30, 1, 0)
)
fumantes_nao_obesos <- subset(fumantes, is_obese == 0)
modelo_2 <- lm(log(charges) ~ bmi + age, data = fumantes_nao_obesos)
summary(modelo_2)
par(mfrow = c(2, 2))
plot(modelo_2)
par(mfrow = c(1, 1))
fumantes_obesos <- subset(fumantes, is_obese == 1)
modelo_2 <- lm(log(charges) ~ bmi + age, data = fumantes_obesos)
summary(modelo_2)
par(mfrow = c(2, 2))
plot(modelo_2)
par(mfrow = c(1, 1))
modelo_2 <- lm(log(charges) ~ (age + bmi) * is_obese, data = fumantes)
summary(modelo_2)
par(mfrow = c(2, 2))
plot(modelo_2)
par(mfrow = c(1, 1))
dados_pt <- dados %>%
rename(
idade = age,
sexo = sex,
imc = bmi,
filhos = children,
fumante = smoker,
regiao = region,
custos = charges
) %>%
mutate(
eh_fumante = ifelse(fumante == "yes", 1, 0),
sexo_masculino = ifelse(sexo == "male", 1, 0),
regiao_norte = ifelse(grepl("north", regiao), 1, 0),
regiao_leste = ifelse(grepl("east", regiao), 1, 0)
)
dados_pt <- dados_pt %>%
select_if(is.numeric)
head(dados_pt)
summary(dados_pt)
ggplot(dados_pt, aes(y = imc)) +
geom_boxplot(fill = "orange") +
labs(title = "Distribuição do IMC", y = "Índice de Massa Corporal (IMC)") +
theme_minimal()
nao_fumantes <- subset(dados_pt, eh_fumante == 0) %>% select(-eh_fumante)
matriz_cor <- cor(nao_fumantes)
corrplot(matriz_cor, method = "number", type = "upper")
ggplot(dados, aes(x = bmi, y = charges, color = smoker)) +
geom_point(alpha = 0.7) +
geom_smooth(method = "lm", se = FALSE) +
labs(
title = "Custos Médicos vs. IMC",
subtitle = "Colorido por status de fumante",
x = "IMC",
y = "Custos ($)"
) +
theme_minimal()
ggplot(nao_fumantes, aes(x = filhos, y = custos)) +
geom_point(alpha = 0.7,
fill = "orange",
color = "black",
shape = 21, size = 3) +
geom_smooth(method = "lm",
se = FALSE,
linetype = "dotted",
linewidth = 1.5) +
labs(
title = "Custos Médicos x Número de filhos",
x = "Número de filhos",
y = "Custos Médicos ($)"
) +
theme_minimal() + theme(plot.title = element_text(hjust = 0.5))
ggplot(dados_pt, aes(x = factor(regiao_norte),
y = custos,
fill = factor(regiao_norte))) +
geom_boxplot(show.legend = FALSE) +
scale_x_discrete(labels = c("0" = "Sul", "1" = "Norte")) +
scale_fill_manual(values = c("0" = "skyblue", "1" = "orange")) +
labs(
title = "Comparação de Custos Médicos: Norte vs. Sul",
x = "Região",
y = "Custos Médicos ($)"
) +
theme_minimal()
modelo_nao_fumantes <- lm(log(custos) ~ idade + filhos + regiao_norte + I(idade^2), data = nao_fumantes)
summary(modelo_nao_fumantes)
par(mfrow = c(2, 2))
plot(modelo_nao_fumantes)
par(mfrow = c(1, 1))
